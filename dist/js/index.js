import{gsap}from"gsap";import{ScrollTrigger}from"gsap/ScrollTrigger";import SplitType from"split-type";import{init,tick,stopTick}from"./three.js";import{loadCases}from"./cases.js";import{loadWork}from"./work.js";import{loadFooter}from"./footer.js";import{loadHeader}from"./header.js";import{localize,switchLang,getLocale}from"./localization.js";import{pagesTransitionsEx}from"./pages.js";let locale;const mobileWidth=992;function setCookie(e,t,o){const n=new Date;n.setTime(n.getTime()+24*o*60*60*1e3);let l="expires="+n.toUTCString();document.cookie=e+"="+t+";"+l+";path=/"}function getCookie(e){let t=e+"=",o=decodeURIComponent(document.cookie).split(";");for(let e=0;e<o.length;e++){let n=o[e];for(;" "==n.charAt(0);)n=n.substring(1);if(0==n.indexOf(t))return n.substring(t.length,n.length)}return""}async function loadPage(){if(await loadHeader(),await loadFooter(),document.querySelectorAll("#language").forEach((e=>e.addEventListener("click",(()=>{window.location.href=window.location.pathname,locale=switchLang(e),setCookie("locale",locale,30)})))),locale=getCookie("locale"),locale||(locale="en",setCookie("locale",locale,30)),await localize(locale),new SplitType(".h1-a"),gsap.timeline().to(".word",{y:0,stagger:.17,duration:1.7,ease:"power4.out",clipPath:"polygon(0% 0%, 100% 0%, 100% 100%, 0% 100%)"}),window.textInterval&&clearInterval(window.textInterval),window.innerWidth<992&&"About Elegy"!==document.title&&(window.textInterval=setInterval((()=>{!function(){const e=gsap.utils.shuffle([...document.querySelectorAll(".char")].filter((()=>Math.random()>.9)));e.length>0&&gsap.timeline().to(e,{color:"#c0b4a7"}).to(e,{color:"#282828"})}()}),500)),window.innerWidth>992){let e=!1;const t=gsap.timeline({});t.to([".menu_li-st"],{y:-30,opacity:0,stagger:.05,duration:.5,ease:"power4.inOut"}),t.to(".menu_btn",{y:0,opacity:1,duration:.5,ease:"power4.inOut"}),window.onscroll=function(o){const n=document.querySelector(".h1-t").getBoundingClientRect().top;e&&window.scrollY<n?(t.reverse(),e=!e):!e&&window.scrollY>=n&&self.oldScroll<self.scrollY&&(t.play(),e=!e),self.oldScroll=self.scrollY},window.addEventListener("scroll",(()=>{onscroll()})),t.pause(),document.querySelector(".menu_btn").addEventListener("click",(()=>{t.reverse(),e=!1}))}if(window.innerWidth<=992){const e=document.querySelector(".menu_btn");let t=!1;const o=gsap.timeline();e.addEventListener("click",(()=>{0==t?(e.textContent="Close -",o.to(".menu_layout",{height:"100%",display:"block",y:0,ease:"expo.InOut",duration:.7}),o.from(".menu_li_lay-st",{y:30,opacity:0,stagger:.1,clipPath:"polygon(0% 0%, 100% 0%, 100% 0%, 0% 0%)",duration:.7}),t=!0):(e.textContent="Menu +",o.to(".menu_layout",{height:"0%",display:"none",y:-200,ease:"expo.InOut",duration:.7}),t=!1)}))}document.querySelectorAll(".div_cont").forEach((e=>{e.addEventListener("click",(()=>{gsap.to(".contacts_layout",{y:0,ease:"expo.InOut",duration:.7}),gsap.set("#contacts",{className:"close_contacts"})}))})),document.querySelector(".close_contacts").addEventListener("click",(()=>{gsap.to(".contacts_layout",{y:"-100%",ease:"expo.InOut",duration:.7}),gsap.set("#contacts",{className:"div_cont"})}));const e=document.querySelector(".more-hover"),t=document.querySelector(".more_btn");function o(e){return e<10&&(e="0"+e),e}gsap.set(t,{xPercent:-50,yPercent:-50}),e.addEventListener("mousemove",(function(o){const{left:n,top:l,width:a,height:i}=e.getBoundingClientRect(),r=a/2,c=i/2,s=o.x-n,d=o.y-l,u=gsap.utils.interpolate(-r,r,s/a),p=gsap.utils.interpolate(-c,c,d/i);gsap.to(t,{x:u,y:p,duration:.6,opacity:1,scale:1,ease:"power1"})})),e.addEventListener("mouseleave",(function(e){gsap.to(t,{x:0,y:0,opacity:0,scale:.5,ease:"power1",duration:.6})})),"About Elegy"===document.title?(init(992),tick()):(stopTick(),"Elegy Studio"===document.title?(gsap.to(".showreel_wr",{width:"100%",ease:"power4.inOut",scrollTrigger:{trigger:".showreel_trig",start:"top center",end:"top top",scrub:4}}),gsap.to(".load_anim",{y:0,delay:1.2,duration:1.2,ease:"power4.inOut",clipPath:"polygon(0% 100%, 100% 100%, 100% 0%, 0% 0%)"})):"Our cases"===document.title?loadCases():"How we work"===document.title&&loadWork()),document.getElementById("date_now").innerHTML=function(){const e=new Date;return o(e.getFullYear())+"."+o(e.getMonth()+1)+"."+o(e.getDate())}(),pagesTransitionsEx(loadPage)}gsap.registerPlugin(ScrollTrigger),loadPage();